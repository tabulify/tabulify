#!/usr/bin/env bash
# Create a tag

if [ -z "$1" ]; then
	echo "Please provide a tag."
	echo "Usage: ./release-tag v[X.Y.Z]"
	exit
fi

tag_name=$1;

# Delete the tag if it exists (both locally and remotely)
if git tag -l | grep -q "^${tag_name}$"; then
    echo "Deleting existing local tag: $tag_name"
    git tag -d "$tag_name"
fi

# Check if tag exists on remote and delete it
if git ls-remote --tags origin | grep -q "refs/tags/${tag_name}$"; then
    echo "Deleting existing remote tag: $tag_name"
    git push origin --delete "$tag_name"
fi

echo "Creating Tag $1"
git tag "$1"
echo "Pushing Tag $1"
git push origin tag "$1"
