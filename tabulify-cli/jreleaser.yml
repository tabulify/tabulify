# $schema: https://jreleaser.org/schema/jreleaser-schema-1.17.0.json

environment:
  properties:
    jdkPathPrefix: '/tmp/jdks/temurin'
    jdkDirectoryName: 'jdk-11.0.26+4'
    depsPrefix: 'target/deps'

# https://jreleaser.org/guide/latest/reference/project.html
project:
  name: tabulify-cli
  #version: '{{projectVersion}}'
  description: Tabulify CLI application
  longDescription: |
    Tabulify CLI application for data manipulation and analysis.
  authors:
    - Tabulify Team
  copyright: '{{project.inceptionYear}}` Eraldy.com'
  license: FSL without Future License
  inceptionYear: '2020'
  tags:
    - cli
    - sql
    - csv
    - data processing
  links:
    homepage: https://www.tabulify.com
    documentation: https://www.tabulify.com
  languages:
    java:
      groupId: com.tabulify
      artifactId: tabulify-cli
      mainClass: com.tabulify.tabli.Tabli
      version: '11.0.26'
      multiProject: true
  stereotype: CLI

# Create a github release
release:
  github:
    owner: EraldyHq
    name: tabulify

# Execute with jreleaser assemble
assemble:
  # https://jreleaser.org/guide/latest/reference/assemble/jlink.html
  jlink:
    # Assembly Name
    # Use in the name of the assembly
    # Example: tabulify-early-access-linux-x86_64.zip
    tabulify:
      active: ALWAYS
      imageName: '{{distributionName}}-{{projectEffectiveVersion}}'
      executable: tabli
      fileSets:
        - input: '.'
          includes:
            - LICENSE.md
      jdeps:
        multiRelease: '11'
        ignoreMissingDeps: true
        targets:
          - 'target/tabulify-cli-{{projectVersion}}.jar'
      additionalModuleNames:
        - 'java.rmi'
        - 'java.security.sasl'
        - 'java.security.jgss'
        - 'jdk.crypto.cryptoki'
        - 'jdk.crypto.ec'
        - 'jdk.localedata'
        - 'jdk.net'
        - 'jdk.security.auth'
        - 'jdk.security.jgss'
      targetJdks:
        - path: '{{jdkPathPrefix}}Linux/{{jdkDirectoryName}}'
          platform: 'linux-x86_64'
        - path: '{{jdkPathPrefix}}Windows/{{jdkDirectoryName}}'
          platform: 'windows-x86_64'
        - path: '{{jdkPathPrefix}}Osx/{{jdkDirectoryName}}'
          platform: 'osx-x86_64'
      mainJar:
        path: 'target/tabulify-cli-{{projectVersion}}.jar'
      jars:
        - pattern: '{{depsPrefix}}/*.jar'
      swid:
        tagRef: swid-tag

distributions:
  # Single Executable Jar
  # Doc: https://jreleaser.org/guide/latest/concepts/distributions/single-jar.html
  # Example: https://jreleaser.org/guide/latest/examples/java/single-jar.html
  fatjar:
    type: SINGLE_JAR
    artifacts:
      - path: target/{{distributionName}}-{{projectVersion}}-fatjar.jar


packagers:
  brew:
    active: ALWAYS
    multiPlatform: true
  chocolatey:
    active: ALWAYS
  docker:
    active: ALWAYS
    imageNames:
      - "tabulify/{{distributionName}}:{{tagName}}"
      - "tabulify/{{distributionName}}:latest"

