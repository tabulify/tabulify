====== Bytle Db - Getting started ======


====== Introduction ======

[[start|Bytle-Db]] is a database software development kit (sdk) that helps you perform operations against any databases at the command line in a simple and effective way.

This ''Getting Started'' will demonstrate basic database relational operations such as:
  * [[#listing_tables|listing tables]]
  * [[#creating_a_sample_schema|creating sample tables]]
  * [[#filling_the_schema_with_data|filling tables with data]]
  * [[#listing_the_relations_between_tables_ie_foreign_key|listing the relationship between tables]]
  * [[#execute_a_query|executing a query]]
  * [[#executing_a_query_benchmark|executing multiple queries (ie query benchmark)]]



====== Steps ======
===== Installation =====
To install [[db|Bytle-Db]] on your computer, follow the instructions on the [[install|installation page]]

===== Command line Syntax =====
  * Typing ''db'' at the command line should give you the following response
<unit>
<code dos>
db
</code>
<console>
A Sdk for the database

Syntax: (1)

	db [options|flags] <command>

where:

	Command (is one of):
		* table                         operations on one or several tables
		* database                      operations on database
		* schema                        operations on a schema
		* query                         operations on a query
		* sample                        create and fill data into a sample schema
		* fkey                          operations on foreign key (ie on relation and constraints between tables)

	Local: (1)
		* -h,--help                     Print this help
		* --conf <path>                 The path to the config file
		* --db.target.url <value>       No Description available
		* --db.target.driver <value>    No Description available

To load data from a csv file you would type:
db table load TABLE_NAME.csv
</console>
</unit>

[[db|db]] is a command line client that is made of the following [[module|module]]:
  * [[table:table]]
  * [[schema]]
  * [[query]]

For each ''sub-command'', you may specify optional [[option|options]] that change the default behavior. 

===== Listing tables =====

''db'' uses as default database a local embedded ''sqlite'' database.

To list all ''tables'' in your current database schema, you need to perform the following command:
<unit>
<code dos>
db table list
</code>
<console>
Jun 27, 2019 6:13:09 PM oracle.jdbc.driver.OracleDriver registerMBeans
WARNING: Error while registering Oracle JDBC Diagnosability MBean.
java.security.AccessControlException: access denied ("javax.management.MBeanTrustPermission" "register")
	at java.security.AccessControlContext.checkPermission(AccessControlContext.java:472)
	at java.lang.SecurityManager.checkPermission(SecurityManager.java:585)
	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.checkMBeanTrustPermission(DefaultMBeanServerInterceptor.java:1848)
	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerMBean(DefaultMBeanServerInterceptor.java:322)
	at com.sun.jmx.mbeanserver.JmxMBeanServer.registerMBean(JmxMBeanServer.java:522)
	at oracle.jdbc.driver.OracleDriver.registerMBeans(OracleDriver.java:367)
	at oracle.jdbc.driver.OracleDriver$1.run(OracleDriver.java:201)
	at java.security.AccessController.doPrivileged(Native Method)
	at oracle.jdbc.driver.OracleDriver.<clinit>(OracleDriver.java:197)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at java.lang.Class.newInstance(Class.java:442)
	at java.util.ServiceLoader$LazyIterator.nextService(ServiceLoader.java:380)
	at java.util.ServiceLoader$LazyIterator.access$700(ServiceLoader.java:323)
	at java.util.ServiceLoader$LazyIterator$2.run(ServiceLoader.java:407)
	at java.security.AccessController.doPrivileged(Native Method)
	at java.util.ServiceLoader$LazyIterator.next(ServiceLoader.java:409)
	at java.util.ServiceLoader$1.next(ServiceLoader.java:480)
	at java.sql.DriverManager$2.run(DriverManager.java:603)
	at java.sql.DriverManager$2.run(DriverManager.java:583)
	at java.security.AccessController.doPrivileged(Native Method)
	at java.sql.DriverManager.loadInitialDrivers(DriverManager.java:583)
	at java.sql.DriverManager.<clinit>(DriverManager.java:101)
	at org.sqlite.JDBC.<clinit>(JDBC.java:29)
	at java.lang.Class.forName0(Native Method)
	at java.lang.Class.forName(Class.java:264)
	at net.bytle.db.database.Database.getNewConnection(Database.java:475)
	at net.bytle.db.database.Database.getCurrentConnection(Database.java:386)
	at net.bytle.db.database.Database.getDatabaseProductName(Database.java:419)
	at net.bytle.db.database.Database.getCurrentSchema(Database.java:687)
	at net.bytle.db.cli.DbTableList.run(DbTableList.java:62)
	at net.bytle.db.cli.DbTable.run(DbTable.java:72)
	at net.bytle.db.cli.Db.main(Db.java:116)
	at javademo.run(javademo.java:3)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at net.bytle.doctest.DocTestCodeRunner.eval(DocTestCodeRunner.java:201)
	at net.bytle.doctest.DocTestRunner.run(DocTestRunner.java:89)
	at net.bytle.doctest.DocTest.Run(DocTest.java:40)
	at net.bytle.db.cli.doc.DbDocTest.docTest(DbDocTest.java:25)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:68)
	at com.intellij.rt.execution.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:47)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:242)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:70)


Tables:

Table Name                 Count   
----------------------   -------   
D_TIME                       100   
D_TIME_TRANSFER              200   
call_center                    2   
catalog_page               11718   
catalog_returns             8923   
catalog_sales              89807   
characters                    16   
customer                    1000   
customer_address            1000   
customer_demographics    1920800   
date_dim                   73049   
dbgen_version                 17   
household_demographics      7200   
income_band                   20   
inventory                 261261   
item                        2000   
promotion                      3   
reason                         1   
ship_mode                     20   
store                          2   
store_returns              11925   
store_sales               120527   
time_dim                   86400   
warehouse                      1   
web_page                       2   
web_returns                 1152   
web_sales                  11876   
web_site                       2
</console>
</unit>

There is obviously no table in our default database. We will create some below by creating a [[sample|sample database]].

===== Creating a sample schema =====
The [[sample|sample module]] provides several sample database. We will create the [[tpcds|tpcds]] datawarehouse part with the ''create'' command.

<unit>
<code dos>
db sample create tpcds-dwh
</code>
<console>
Table (reason) already exist.
Table (customer_demographics) already exist.
Table (date_dim) already exist.
Table (customer_address) already exist.
Table (income_band) already exist.
Table (item) already exist.
Table (ship_mode) already exist.
Table (warehouse) already exist.
Table (time_dim) already exist.
Table (dbgen_version) already exist.
Table (web_site) already exist.
Table (store) already exist.
Table (call_center) already exist.
Table (catalog_page) already exist.
Table (household_demographics) already exist.
Table (promotion) already exist.
Table (inventory) already exist.
Table (customer) already exist.
Table (web_page) already exist.
Table (store_sales) already exist.
Table (catalog_sales) already exist.
Table (web_sales) already exist.
Table (store_returns) already exist.
Table (catalog_returns) already exist.
Table (web_returns) already exist.
</console>
</unit>
<wrap info>Note that the tables are not created by alphabetic order but by foreign key graph order. (Ie the primary key must be created before the foreign key).
That's why we see at the end of the list most of the fact tables. They are created after the dimensions.</wrap>

  * How many tables do we have ?
<unit>
<code dos>
db table count
</code>
<console>
28 tables
</console>
</unit>
===== Filling the schema with data =====
To fill our schema with generated data, we will use the ''fill'' sub-command of [[sample|sample]].

<unit>
<code dos>
db sample fill tpcds-dwh
</code>
At the end of the process, you get a list of all tables where data were loaded and the number of row that were inserted.
<console>
The table (reason) exists in the target database (target)
The table (customer_demographics) exists in the target database (target)
The table (date_dim) exists in the target database (target)
The table (customer_address) exists in the target database (target)
The table (income_band) exists in the target database (target)
The table (item) exists in the target database (target)
The table (ship_mode) exists in the target database (target)
The table (warehouse) exists in the target database (target)
The table (time_dim) exists in the target database (target)
The table (dbgen_version) exists in the target database (target)
The table (web_site) exists in the target database (target)
The table (store) exists in the target database (target)
The table (call_center) exists in the target database (target)
The table (catalog_page) exists in the target database (target)
The table (household_demographics) exists in the target database (target)
The table (promotion) exists in the target database (target)
The table (inventory) exists in the target database (target)
The table (customer) exists in the target database (target)
The table (web_page) exists in the target database (target)
The table (store_sales) exists in the target database (target)
The table (catalog_sales) exists in the target database (target)
The table (web_sales) exists in the target database (target)
The table (store_returns) exists in the target database (target)
The table (catalog_returns) exists in the target database (target)
The table (web_returns) exists in the target database (target)
Exception in thread "Table reason, chunk 1" java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: reason.r_reason_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:110)
	at net.bytle.db.tpc.TpcdsDgen.lambda$load$1(TpcdsDgen.java:161)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: reason.r_reason_sk)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:256)
	at net.bytle.db.stream.SqlInsertStream.close(SqlInsertStream.java:217)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:97)
	... 2 more
Caused by: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: reason.r_reason_sk)
	at org.sqlite.core.DB.newSQLException(DB.java:920)
	at org.sqlite.core.DB.newSQLException(DB.java:932)
	at org.sqlite.core.DB.throwex(DB.java:897)
	at org.sqlite.core.DB.executeBatch(DB.java:785)
	at org.sqlite.core.CorePreparedStatement.executeBatch(CorePreparedStatement.java:79)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:252)
	... 4 more
Exception in thread "Table customer_demographics, chunk 1" java.lang.RuntimeException: java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: customer_demographics.cd_demo_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:110)
	at net.bytle.db.tpc.TpcdsDgen.lambda$load$1(TpcdsDgen.java:161)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: customer_demographics.cd_demo_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:94)
	... 2 more
Caused by: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: customer_demographics.cd_demo_sk)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:256)
	at net.bytle.db.stream.SqlInsertStream.insert(SqlInsertStream.java:111)
	at net.bytle.db.stream.InsertStreamAbs.insert(InsertStreamAbs.java:40)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:81)
	... 2 more
Caused by: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: customer_demographics.cd_demo_sk)
	at org.sqlite.core.DB.newSQLException(DB.java:920)
	at org.sqlite.core.DB.newSQLException(DB.java:932)
	at org.sqlite.core.DB.throwex(DB.java:897)
	at org.sqlite.core.DB.executeBatch(DB.java:785)
	at org.sqlite.core.CorePreparedStatement.executeBatch(CorePreparedStatement.java:79)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:252)
	... 5 more
Exception in thread "Table date_dim, chunk 1" java.lang.RuntimeException: java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: date_dim.d_date_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:110)
	at net.bytle.db.tpc.TpcdsDgen.lambda$load$1(TpcdsDgen.java:161)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: date_dim.d_date_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:94)
	... 2 more
Caused by: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: date_dim.d_date_sk)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:256)
	at net.bytle.db.stream.SqlInsertStream.insert(SqlInsertStream.java:111)
	at net.bytle.db.stream.InsertStreamAbs.insert(InsertStreamAbs.java:40)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:81)
	... 2 more
Caused by: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: date_dim.d_date_sk)
	at org.sqlite.core.DB.newSQLException(DB.java:920)
	at org.sqlite.core.DB.newSQLException(DB.java:932)
	at org.sqlite.core.DB.throwex(DB.java:897)
	at org.sqlite.core.DB.executeBatch(DB.java:785)
	at org.sqlite.core.CorePreparedStatement.executeBatch(CorePreparedStatement.java:79)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:252)
	... 5 more
Exception in thread "Table customer_address, chunk 1" java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: customer_address.ca_address_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:110)
	at net.bytle.db.tpc.TpcdsDgen.lambda$load$1(TpcdsDgen.java:161)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: customer_address.ca_address_sk)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:256)
	at net.bytle.db.stream.SqlInsertStream.close(SqlInsertStream.java:217)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:97)
	... 2 more
Caused by: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: customer_address.ca_address_sk)
	at org.sqlite.core.DB.newSQLException(DB.java:920)
	at org.sqlite.core.DB.newSQLException(DB.java:932)
	at org.sqlite.core.DB.throwex(DB.java:897)
	at org.sqlite.core.DB.executeBatch(DB.java:785)
	at org.sqlite.core.CorePreparedStatement.executeBatch(CorePreparedStatement.java:79)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:252)
	... 4 more
Exception in thread "Table income_band, chunk 1" java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: income_band.ib_income_band_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:110)
	at net.bytle.db.tpc.TpcdsDgen.lambda$load$1(TpcdsDgen.java:161)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: income_band.ib_income_band_sk)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:256)
	at net.bytle.db.stream.SqlInsertStream.close(SqlInsertStream.java:217)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:97)
	... 2 more
Caused by: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: income_band.ib_income_band_sk)
	at org.sqlite.core.DB.newSQLException(DB.java:920)
	at org.sqlite.core.DB.newSQLException(DB.java:932)
	at org.sqlite.core.DB.throwex(DB.java:897)
	at org.sqlite.core.DB.executeBatch(DB.java:785)
	at org.sqlite.core.CorePreparedStatement.executeBatch(CorePreparedStatement.java:79)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:252)
	... 4 more
Exception in thread "Table item, chunk 1" java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: item.i_item_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:110)
	at net.bytle.db.tpc.TpcdsDgen.lambda$load$1(TpcdsDgen.java:161)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: item.i_item_sk)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:256)
	at net.bytle.db.stream.SqlInsertStream.close(SqlInsertStream.java:217)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:97)
	... 2 more
Caused by: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: item.i_item_sk)
	at org.sqlite.core.DB.newSQLException(DB.java:920)
	at org.sqlite.core.DB.newSQLException(DB.java:932)
	at org.sqlite.core.DB.throwex(DB.java:897)
	at org.sqlite.core.DB.executeBatch(DB.java:785)
	at org.sqlite.core.CorePreparedStatement.executeBatch(CorePreparedStatement.java:79)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:252)
	... 4 more
Exception in thread "Table ship_mode, chunk 1" java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: ship_mode.sm_ship_mode_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:110)
	at net.bytle.db.tpc.TpcdsDgen.lambda$load$1(TpcdsDgen.java:161)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: ship_mode.sm_ship_mode_sk)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:256)
	at net.bytle.db.stream.SqlInsertStream.close(SqlInsertStream.java:217)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:97)
	... 2 more
Caused by: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: ship_mode.sm_ship_mode_sk)
	at org.sqlite.core.DB.newSQLException(DB.java:920)
	at org.sqlite.core.DB.newSQLException(DB.java:932)
	at org.sqlite.core.DB.throwex(DB.java:897)
	at org.sqlite.core.DB.executeBatch(DB.java:785)
	at org.sqlite.core.CorePreparedStatement.executeBatch(CorePreparedStatement.java:79)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:252)
	... 4 more
Exception in thread "Table warehouse, chunk 1" java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: warehouse.w_warehouse_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:110)
	at net.bytle.db.tpc.TpcdsDgen.lambda$load$1(TpcdsDgen.java:161)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: warehouse.w_warehouse_sk)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:256)
	at net.bytle.db.stream.SqlInsertStream.close(SqlInsertStream.java:217)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:97)
	... 2 more
Caused by: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: warehouse.w_warehouse_sk)
	at org.sqlite.core.DB.newSQLException(DB.java:920)
	at org.sqlite.core.DB.newSQLException(DB.java:932)
	at org.sqlite.core.DB.throwex(DB.java:897)
	at org.sqlite.core.DB.executeBatch(DB.java:785)
	at org.sqlite.core.CorePreparedStatement.executeBatch(CorePreparedStatement.java:79)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:252)
	... 4 more
Exception in thread "Table time_dim, chunk 1" java.lang.RuntimeException: java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: time_dim.t_time_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:110)
	at net.bytle.db.tpc.TpcdsDgen.lambda$load$1(TpcdsDgen.java:161)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: time_dim.t_time_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:94)
	... 2 more
Caused by: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: time_dim.t_time_sk)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:256)
	at net.bytle.db.stream.SqlInsertStream.insert(SqlInsertStream.java:111)
	at net.bytle.db.stream.InsertStreamAbs.insert(InsertStreamAbs.java:40)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:81)
	... 2 more
Caused by: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: time_dim.t_time_sk)
	at org.sqlite.core.DB.newSQLException(DB.java:920)
	at org.sqlite.core.DB.newSQLException(DB.java:932)
	at org.sqlite.core.DB.throwex(DB.java:897)
	at org.sqlite.core.DB.executeBatch(DB.java:785)
	at org.sqlite.core.CorePreparedStatement.executeBatch(CorePreparedStatement.java:79)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:252)
	... 5 more
Exception in thread "Table web_site, chunk 1" java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: web_site.web_site_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:110)
	at net.bytle.db.tpc.TpcdsDgen.lambda$load$1(TpcdsDgen.java:161)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: web_site.web_site_sk)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:256)
	at net.bytle.db.stream.SqlInsertStream.close(SqlInsertStream.java:217)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:97)
	... 2 more
Caused by: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: web_site.web_site_sk)
	at org.sqlite.core.DB.newSQLException(DB.java:920)
	at org.sqlite.core.DB.newSQLException(DB.java:932)
	at org.sqlite.core.DB.throwex(DB.java:897)
	at org.sqlite.core.DB.executeBatch(DB.java:785)
	at org.sqlite.core.CorePreparedStatement.executeBatch(CorePreparedStatement.java:79)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:252)
	... 4 more
Exception in thread "Table store, chunk 1" java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: store.s_store_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:110)
	at net.bytle.db.tpc.TpcdsDgen.lambda$load$1(TpcdsDgen.java:161)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: store.s_store_sk)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:256)
	at net.bytle.db.stream.SqlInsertStream.close(SqlInsertStream.java:217)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:97)
	... 2 more
Caused by: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: store.s_store_sk)
	at org.sqlite.core.DB.newSQLException(DB.java:920)
	at org.sqlite.core.DB.newSQLException(DB.java:932)
	at org.sqlite.core.DB.throwex(DB.java:897)
	at org.sqlite.core.DB.executeBatch(DB.java:785)
	at org.sqlite.core.CorePreparedStatement.executeBatch(CorePreparedStatement.java:79)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:252)
	... 4 more
Exception in thread "Table call_center, chunk 1" java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: call_center.cc_call_center_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:110)
	at net.bytle.db.tpc.TpcdsDgen.lambda$load$1(TpcdsDgen.java:161)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: call_center.cc_call_center_sk)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:256)
	at net.bytle.db.stream.SqlInsertStream.close(SqlInsertStream.java:217)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:97)
	... 2 more
Caused by: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: call_center.cc_call_center_sk)
	at org.sqlite.core.DB.newSQLException(DB.java:920)
	at org.sqlite.core.DB.newSQLException(DB.java:932)
	at org.sqlite.core.DB.throwex(DB.java:897)
	at org.sqlite.core.DB.executeBatch(DB.java:785)
	at org.sqlite.core.CorePreparedStatement.executeBatch(CorePreparedStatement.java:79)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:252)
	... 4 more
Exception in thread "Table catalog_page, chunk 1" java.lang.RuntimeException: java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: catalog_page.cp_catalog_page_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:110)
	at net.bytle.db.tpc.TpcdsDgen.lambda$load$1(TpcdsDgen.java:161)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: catalog_page.cp_catalog_page_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:94)
	... 2 more
Caused by: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: catalog_page.cp_catalog_page_sk)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:256)
	at net.bytle.db.stream.SqlInsertStream.insert(SqlInsertStream.java:111)
	at net.bytle.db.stream.InsertStreamAbs.insert(InsertStreamAbs.java:40)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:81)
	... 2 more
Caused by: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: catalog_page.cp_catalog_page_sk)
	at org.sqlite.core.DB.newSQLException(DB.java:920)
	at org.sqlite.core.DB.newSQLException(DB.java:932)
	at org.sqlite.core.DB.throwex(DB.java:897)
	at org.sqlite.core.DB.executeBatch(DB.java:785)
	at org.sqlite.core.CorePreparedStatement.executeBatch(CorePreparedStatement.java:79)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:252)
	... 5 more
Exception in thread "Table household_demographics, chunk 1" java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: household_demographics.hd_demo_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:110)
	at net.bytle.db.tpc.TpcdsDgen.lambda$load$1(TpcdsDgen.java:161)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: household_demographics.hd_demo_sk)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:256)
	at net.bytle.db.stream.SqlInsertStream.close(SqlInsertStream.java:217)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:97)
	... 2 more
Caused by: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: household_demographics.hd_demo_sk)
	at org.sqlite.core.DB.newSQLException(DB.java:920)
	at org.sqlite.core.DB.newSQLException(DB.java:932)
	at org.sqlite.core.DB.throwex(DB.java:897)
	at org.sqlite.core.DB.executeBatch(DB.java:785)
	at org.sqlite.core.CorePreparedStatement.executeBatch(CorePreparedStatement.java:79)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:252)
	... 4 more
Exception in thread "Table promotion, chunk 1" java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: promotion.p_promo_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:110)
	at net.bytle.db.tpc.TpcdsDgen.lambda$load$1(TpcdsDgen.java:161)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: promotion.p_promo_sk)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:256)
	at net.bytle.db.stream.SqlInsertStream.close(SqlInsertStream.java:217)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:97)
	... 2 more
Caused by: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: promotion.p_promo_sk)
	at org.sqlite.core.DB.newSQLException(DB.java:920)
	at org.sqlite.core.DB.newSQLException(DB.java:932)
	at org.sqlite.core.DB.throwex(DB.java:897)
	at org.sqlite.core.DB.executeBatch(DB.java:785)
	at org.sqlite.core.CorePreparedStatement.executeBatch(CorePreparedStatement.java:79)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:252)
	... 4 more
Exception in thread "Table inventory, chunk 1" java.lang.RuntimeException: java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: inventory.inv_date_sk, inventory.inv_item_sk, inventory.inv_warehouse_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:110)
	at net.bytle.db.tpc.TpcdsDgen.lambda$load$1(TpcdsDgen.java:161)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: inventory.inv_date_sk, inventory.inv_item_sk, inventory.inv_warehouse_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:94)
	... 2 more
Caused by: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: inventory.inv_date_sk, inventory.inv_item_sk, inventory.inv_warehouse_sk)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:256)
	at net.bytle.db.stream.SqlInsertStream.insert(SqlInsertStream.java:111)
	at net.bytle.db.stream.InsertStreamAbs.insert(InsertStreamAbs.java:40)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:81)
	... 2 more
Caused by: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: inventory.inv_date_sk, inventory.inv_item_sk, inventory.inv_warehouse_sk)
	at org.sqlite.core.DB.newSQLException(DB.java:920)
	at org.sqlite.core.DB.newSQLException(DB.java:932)
	at org.sqlite.core.DB.throwex(DB.java:897)
	at org.sqlite.core.DB.executeBatch(DB.java:785)
	at org.sqlite.core.CorePreparedStatement.executeBatch(CorePreparedStatement.java:79)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:252)
	... 5 more
Exception in thread "Table customer, chunk 1" java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: customer.c_customer_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:110)
	at net.bytle.db.tpc.TpcdsDgen.lambda$load$1(TpcdsDgen.java:161)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: customer.c_customer_sk)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:256)
	at net.bytle.db.stream.SqlInsertStream.close(SqlInsertStream.java:217)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:97)
	... 2 more
Caused by: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: customer.c_customer_sk)
	at org.sqlite.core.DB.newSQLException(DB.java:920)
	at org.sqlite.core.DB.newSQLException(DB.java:932)
	at org.sqlite.core.DB.throwex(DB.java:897)
	at org.sqlite.core.DB.executeBatch(DB.java:785)
	at org.sqlite.core.CorePreparedStatement.executeBatch(CorePreparedStatement.java:79)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:252)
	... 4 more
Exception in thread "Table web_page, chunk 1" java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: web_page.wp_web_page_sk)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:110)
	at net.bytle.db.tpc.TpcdsDgen.lambda$load$1(TpcdsDgen.java:161)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: web_page.wp_web_page_sk)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:256)
	at net.bytle.db.stream.SqlInsertStream.close(SqlInsertStream.java:217)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:97)
	... 2 more
Caused by: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: web_page.wp_web_page_sk)
	at org.sqlite.core.DB.newSQLException(DB.java:920)
	at org.sqlite.core.DB.newSQLException(DB.java:932)
	at org.sqlite.core.DB.throwex(DB.java:897)
	at org.sqlite.core.DB.executeBatch(DB.java:785)
	at org.sqlite.core.CorePreparedStatement.executeBatch(CorePreparedStatement.java:79)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:252)
	... 4 more
Exception in thread "Table store_sales, chunk 1" java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: store_returns.sr_item_sk, store_returns.sr_ticket_number)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:110)
	at net.bytle.db.tpc.TpcdsDgen.lambda$load$1(TpcdsDgen.java:161)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: store_returns.sr_item_sk, store_returns.sr_ticket_number)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:256)
	at net.bytle.db.stream.SqlInsertStream.close(SqlInsertStream.java:217)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:99)
	... 2 more
Caused by: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: store_returns.sr_item_sk, store_returns.sr_ticket_number)
	at org.sqlite.core.DB.newSQLException(DB.java:920)
	at org.sqlite.core.DB.newSQLException(DB.java:932)
	at org.sqlite.core.DB.throwex(DB.java:897)
	at org.sqlite.core.DB.executeBatch(DB.java:785)
	at org.sqlite.core.CorePreparedStatement.executeBatch(CorePreparedStatement.java:79)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:252)
	... 4 more
Exception in thread "Table catalog_sales, chunk 1" java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: catalog_returns.cr_item_sk, catalog_returns.cr_order_number)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:110)
	at net.bytle.db.tpc.TpcdsDgen.lambda$load$1(TpcdsDgen.java:161)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: catalog_returns.cr_item_sk, catalog_returns.cr_order_number)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:256)
	at net.bytle.db.stream.SqlInsertStream.close(SqlInsertStream.java:217)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:99)
	... 2 more
Caused by: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: catalog_returns.cr_item_sk, catalog_returns.cr_order_number)
	at org.sqlite.core.DB.newSQLException(DB.java:920)
	at org.sqlite.core.DB.newSQLException(DB.java:932)
	at org.sqlite.core.DB.throwex(DB.java:897)
	at org.sqlite.core.DB.executeBatch(DB.java:785)
	at org.sqlite.core.CorePreparedStatement.executeBatch(CorePreparedStatement.java:79)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:252)
	... 4 more
Exception in thread "Table web_sales, chunk 1" java.lang.RuntimeException: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: web_returns.wr_item_sk, web_returns.wr_order_number)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:110)
	at net.bytle.db.tpc.TpcdsDgen.lambda$load$1(TpcdsDgen.java:161)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.RuntimeException: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: web_returns.wr_item_sk, web_returns.wr_order_number)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:256)
	at net.bytle.db.stream.SqlInsertStream.close(SqlInsertStream.java:217)
	at net.bytle.db.tpc.TpcdsDgenTable.generateTable(TpcdsDgenTable.java:99)
	... 2 more
Caused by: org.sqlite.SQLiteException: [SQLITE_CONSTRAINT_PRIMARYKEY]  A PRIMARY KEY constraint failed (UNIQUE constraint failed: web_returns.wr_item_sk, web_returns.wr_order_number)
	at org.sqlite.core.DB.newSQLException(DB.java:920)
	at org.sqlite.core.DB.newSQLException(DB.java:932)
	at org.sqlite.core.DB.throwex(DB.java:897)
	at org.sqlite.core.DB.executeBatch(DB.java:785)
	at org.sqlite.core.CorePreparedStatement.executeBatch(CorePreparedStatement.java:79)
	at net.bytle.db.stream.SqlInsertStream.executeBatch(SqlInsertStream.java:252)
	... 4 more
Results:
Tables Loaded   Rows Inserted   
-------------   -------------   
dbgen_version               1
</console>
</unit>

===== Listing the tables again =====

You could list information on the table with the ''list'' command. <wrap info>Note that the output must be the same than the ''db sample fill'' command.</wrap>
<unit>
<code dos>
db table list
</code>
<console>
Tables:

Table Name                 Count   
----------------------   -------   
D_TIME                       100   
D_TIME_TRANSFER              200   
call_center                    2   
catalog_page               11718   
catalog_returns             8923   
catalog_sales              89807   
characters                    16   
customer                    1000   
customer_address            1000   
customer_demographics    1920800   
date_dim                   73049   
dbgen_version                 18   
household_demographics      7200   
income_band                   20   
inventory                 261261   
item                        2000   
promotion                      3   
reason                         1   
ship_mode                     20   
store                          2   
store_returns              11925   
store_sales               120527   
time_dim                   86400   
warehouse                      1   
web_page                       2   
web_returns                 1152   
web_sales                  11876   
web_site                       2
</console>
</unit>

===== Listing the relations between tables (ie foreign key) =====

<unit>
<code dos>
db fkey list
</code>
<console>
ForeignKeys:
Id   Child Table              <-   Parent Table             From Foreign Key             
--   ----------------------   --   ----------------------   --------------------------   
 1   call_center              <-   date_dim                 call_center_fk1              
 2   catalog_page             <-   date_dim                 catalog_page_fk0             
 3   catalog_returns          <-   call_center              catalog_returns_fk7          
 4   catalog_returns          <-   catalog_page             catalog_returns_fk9          
 5   catalog_returns          <-   catalog_sales            catalog_returns_fk8          
 6   catalog_returns          <-   customer                 catalog_returns_fk6          
 7   catalog_returns          <-   customer_address         catalog_returns_fk1          
 8   catalog_returns          <-   customer_demographics    catalog_returns_fk16         
 9   catalog_returns          <-   date_dim                 catalog_returns_fk2          
10   catalog_returns          <-   household_demographics   catalog_returns_fk10         
11   catalog_returns          <-   item                     catalog_returns_fk4          
12   catalog_returns          <-   reason                   catalog_returns_fk3          
13   catalog_returns          <-   ship_mode                catalog_returns_fk11         
14   catalog_returns          <-   time_dim                 catalog_returns_fk5          
15   catalog_returns          <-   warehouse                catalog_returns_fk13         
16   catalog_sales            <-   call_center              catalog_sales_fk10           
17   catalog_sales            <-   catalog_page             catalog_sales_fk12           
18   catalog_sales            <-   customer                 catalog_sales_fk13           
19   catalog_sales            <-   customer_address         catalog_sales_fk8            
20   catalog_sales            <-   customer_demographics    catalog_sales_fk16           
21   catalog_sales            <-   date_dim                 catalog_sales_fk14           
22   catalog_sales            <-   household_demographics   catalog_sales_fk15           
23   catalog_sales            <-   item                     catalog_sales_fk2            
24   catalog_sales            <-   promotion                catalog_sales_fk3            
25   catalog_sales            <-   ship_mode                catalog_sales_fk0            
26   catalog_sales            <-   time_dim                 catalog_sales_fk9            
27   catalog_sales            <-   warehouse                catalog_sales_fk1            
28   customer                 <-   customer_address         customer_fk3                 
29   customer                 <-   customer_demographics    customer_fk5                 
30   customer                 <-   date_dim                 customer_fk2                 
31   customer                 <-   household_demographics   customer_fk4                 
32   household_demographics   <-   income_band              household_demographics_fk0   
33   inventory                <-   date_dim                 inventory_fk0                
34   inventory                <-   item                     inventory_fk1                
35   inventory                <-   warehouse                inventory_fk2                
36   promotion                <-   date_dim                 promotion_fk2                
37   promotion                <-   item                     promotion_fk1                
38   store_returns            <-   customer                 store_returns_fk0            
39   store_returns            <-   customer_address         store_returns_fk8            
40   store_returns            <-   customer_demographics    store_returns_fk3            
41   store_returns            <-   date_dim                 store_returns_fk4            
42   store_returns            <-   household_demographics   store_returns_fk2            
43   store_returns            <-   item                     store_returns_fk5            
44   store_returns            <-   reason                   store_returns_fk9            
45   store_returns            <-   store                    store_returns_fk7            
46   store_returns            <-   store_sales              store_returns_fk1            
47   store_returns            <-   time_dim                 store_returns_fk6            
48   store_sales              <-   customer                 store_sales_fk8              
49   store_sales              <-   customer_address         store_sales_fk1              
50   store_sales              <-   customer_demographics    store_sales_fk5              
51   store_sales              <-   date_dim                 store_sales_fk3              
52   store_sales              <-   household_demographics   store_sales_fk6              
53   store_sales              <-   item                     store_sales_fk7              
54   store_sales              <-   promotion                store_sales_fk0              
55   store_sales              <-   store                    store_sales_fk2              
56   store_sales              <-   time_dim                 store_sales_fk4              
57   store                    <-   date_dim                 store_fk0                    
58   web_page                 <-   customer                 web_page_fk2                 
59   web_page                 <-   date_dim                 web_page_fk0                 
60   web_returns              <-   customer                 web_returns_fk1              
61   web_returns              <-   customer_address         web_returns_fk9              
62   web_returns              <-   customer_demographics    web_returns_fk0              
63   web_returns              <-   date_dim                 web_returns_fk8              
64   web_returns              <-   household_demographics   web_returns_fk5              
65   web_returns              <-   item                     web_returns_fk11             
66   web_returns              <-   reason                   web_returns_fk12             
67   web_returns              <-   time_dim                 web_returns_fk6              
68   web_returns              <-   web_page                 web_returns_fk7              
69   web_returns              <-   web_sales                web_returns_fk10             
70   web_sales                <-   customer                 web_sales_fk5                
71   web_sales                <-   customer_address         web_sales_fk8                
72   web_sales                <-   customer_demographics    web_sales_fk4                
73   web_sales                <-   date_dim                 web_sales_fk15               
74   web_sales                <-   household_demographics   web_sales_fk7                
75   web_sales                <-   item                     web_sales_fk6                
76   web_sales                <-   promotion                web_sales_fk16               
77   web_sales                <-   ship_mode                web_sales_fk9                
78   web_sales                <-   time_dim                 web_sales_fk14               
79   web_sales                <-   warehouse                web_sales_fk10               
80   web_sales                <-   web_page                 web_sales_fk11               
81   web_sales                <-   web_site                 web_sales_fk12               
82   web_site                 <-   date_dim                 web_site_fk0                 

Tip: You can show the columns by adding the c flag.
</console>
</unit>

===== Execute a Query =====

Tpcds offers 100 queries. We will execute the query number 11 with the [[execute|execute]] command of the query module. 

The file containing this query is located at
''DB_HOME\sql\tpcds\query\sqlite\query_11.sql'' where ''DB_HOME'' is where you have [[install|unzipped/installed Bytle Db]].

Below is an excerpt because this query is very long.

It shows customers that have generated growing sales from one year to another in the ''s'' and ''w'' sales type.

<code sql query_11.sql>
with year_total as (
 select c_customer_id customer_id
       ,c_first_name customer_first_name
       ,c_last_name customer_last_name
       ,c_preferred_cust_flag customer_preferred_cust_flag
       ,c_birth_country customer_birth_country
       ,c_login customer_login
       ,c_email_address customer_email_address
       ,d_year dyear
       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total
       ,'s' sale_type
 from customer
     ,store_sales
     ,date_dim
 where
...
</code>
  * Executing the query will show us this customers.
<unit envBYTLE_DB_HOME=.\src\main>
<code dos db_query_execute.cmd>
db query execute %BYTLE_DB_HOME%\sql\tpcds\query\sqlite\query_11.sql
</code> 
<console>
The first argument value seems not to be a file, a directory or a query
The argument value is: 
.\src\main\sql\tpcds\query\sqlite\query_11.sql

Execute one or several queries

Syntax: (1)

	db query execute [options|flags] <Query|File.sql|Directory>

where:

	Local: (1)
		* --sd <value>                  defines the SOURCE driver for the SOURCE database (Example: oracle.jdbc.OracleDriver)

	Args:
		* Query|File.sql|Directory      The query defines as a command line argument, a query file or a directory of query files


Example:
db execute --output QueryDownloaded.csv QueryToDownload.sql
</console>
</unit>


===== Executing a Query benchmark =====
''Bytle-Db'' is able to [[execute|execute]] every query stored in ''sql'' files in a directory.

[[tpcds|tpcds]] is a benchmark and offers 100 queries that we will execute. 

<wrap info>All 100 queries are not present because ''Sqlite'' does not implement all standard ANSI clause but as since version [[https://www.sqlite.org/draft/releaselog/3_25_0.html|3.25]] support window functions, most of the analytics query are working.</wrap>

All ''Tpcds'' queries are located at ''DB_HOME\sql\tpcds\query\sqlite'' where ''DB_HOME'' is the directory where ''Bytle-Db'' was unzipped/installed.

<unit envBYTLE_DB_HOME=.\src\main>
<code dos>
db query execute %BYTLE_DB_HOME%\sql\tpcds\query\sqlite
</code>
<console>
The first argument value seems not to be a file, a directory or a query
The argument value is: 
.\src\main\sql\tpcds\query\sqlite

Execute one or several queries

Syntax: (1)

	db query execute [options|flags] <Query|File.sql|Directory>

where:

	Local: (1)
		* --sd <value>                  defines the SOURCE driver for the SOURCE database (Example: oracle.jdbc.OracleDriver)

	Args:
		* Query|File.sql|Directory      The query defines as a command line argument, a query file or a directory of query files


Example:
db execute --output QueryDownloaded.csv QueryToDownload.sql
</console>
</unit>
